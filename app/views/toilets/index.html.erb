<p id="notice"><%= notice %></p>

<hr>
  <% if user_signed_in? %>
    <p>
      ようこそ！<%= current_user.user_name %>さん
      <hr>
      ◆アイコン表示テスト◆<br>
      <% if current_user.image.attached? %>
        <%= image_tag current_user.image.variant(resize_to_limit: [65, 65]), class: "image-display" %>
      <% else %>
        <img src="assets/default_image.png" class="image-display">
      <% end %>
      <hr>
      ◆ユーザーID◆<br>
      <%= current_user.id %>
      <hr>
      ◆メールアドレス◆<br>
      <%= current_user.email %>
      <hr>
      ◆アイコンのメタ情報？◆<br>
      <%= current_user.image %>
      <hr>
      <hr>
      <br>
      <%= link_to 'ログアウト', '/users/sign_out/', method: :delete %>
    </p>
  <% else %>
    <p>
      <%= link_to 'ログイン', '/users/sign_in/', class:'btn-sign_in' %>
      <%= link_to '新規登録', '/users/sign_up/', class:'btn-sign_up' %>
    </p>

  <% end %>



<hr>

<h1>トイレ一覧</h1>
◆直近に登録された5件を表示したい◆
<br>
<table>
  <thead>
    <tr>
      <th>登録日時</th>
      <th>トイレ名称</th>
      <th>営業時間</th>
      <th>備考</th>
    </tr>
  </thead>

  <tbody>
    <% @toilets.each do |toilet| %>
      <tr>
        <td><%= toilet.created_at %></td>
        <td><%= link_to toilet.toilet_name, toilet %></td>
        <td>
          <span>
            <%= toilet.open_time.strftime( "%H:%M" ) %>-<%= toilet.close_time.strftime( "%H:%M" ) %>
          </span>
        </td>
        <td><%= toilet.remark %></td>
      </tr>
    <% end %>
  </tbody>
</table>


<hr>
◆とりあえず並べたやつ◆
<table>
  <thead>
    <tr>
      <th>id</th>
      <th>トイレ名称</th>
      <th>多目的トイレ</th>
      <th>[男]小便器数</th>
      <th>[男]個室数</th>
      <th>[男]ウォシュレット</th>
      <th>[女]個室数</th>
      <th>[女]ウォシュレット</th>
      <th>営業時間</th>
      <th>備考</th>
      <th>緯度</th>
      <th>経度</th>
      <th>User_id</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @toilets.each do |toilet| %>
      <tr>
        <td><%= toilet.id %></td>
        <td><%= toilet.toilet_name %></td>
        <td><%= toilet.multipurpose %></td>
        <td><%= toilet.m_urinal %></td>
        <td><%= toilet.m_room %></td>
        <td><%= toilet.m_washlet %></td>
        <td><%= toilet.w_room %></td>
        <td><%= toilet.w_washlet %></td>
        <td>
          <span>
            <%= toilet.open_time.strftime( "%H:%M" ) %>-<%= toilet.close_time.strftime( "%H:%M" ) %>
          </span>
        </td>
        <td><%= toilet.remark %></td>
        <td><%= toilet.latitude %></td>
        <td><%= toilet.longtitude %></td>
        <td><%= toilet.user_id %></td>
        <td><%= link_to 'Show', toilet %></td>
        <td><%= link_to 'Edit', edit_toilet_path(toilet) %></td>
        <td><%= link_to 'Destroy', toilet, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'トイレ情報を登録する', new_toilet_path %>


<!-- 以下、GooglemapAPIテスト記述 -->

<h2>gmap</h2>
<div id='map_index'></div>

<style>
#map_index {
  height: 400px;
}
</style>

<script>
// マップを生成
function initMap(){
  let map = new google.maps.Map(document.getElementById('map_index'), {
    center: { lat: 35.681, lng: 139.767 }, //マップの中心
    zoom: 12,                  //マップの解析度
    // mapTypeControl: false,     //オプション
    // streetViewControl: false   //オプション
  });

  // 複数マーカーの作成
  <% @toilets.each do |toilet| %>
  (function() {
    let marker = new google.maps.Marker({
      position: {lat: <%= toilet.latitude %>, lng: <%= toilet.longtitude %>},
      map: map,
    });
  })();
  <% end %>
}
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDgk50-Uh4K60ddzGNY5yOcfx4clQMNYNU&callback=initMap" async defer></script>
